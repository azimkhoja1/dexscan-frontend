<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DexScan Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #0b0c10;
      color: #fff;
      margin: 0;
      padding: 0;
    }
    header {
      background: #1f2833;
      text-align: center;
      padding: 1rem 0;
      font-size: 1.5rem;
      font-weight: bold;
      letter-spacing: 1px;
    }
    .container {
      width: 90%;
      max-width: 1100px;
      margin: 2rem auto;
    }
    .section {
      background: #1c1c1c;
      border-radius: 10px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      text-align: left;
      padding: 10px;
      border-bottom: 1px solid #333;
    }
    th {
      background-color: #0b0c10;
      color: #66fcf1;
    }
    .buy { color: #00ff99; font-weight: bold; }
    .sell { color: #ff5555; font-weight: bold; }
  </style>
</head>
<body>
  <header>ðŸ’¹ DexScan AI Dashboard</header>
  <div class="container">
    
    <!-- ðŸ”¹ Top 10 Coins -->
    <div class="section">
      <h2>Top 10 Cryptos</h2>
      <table id="top10-table">
        <thead><tr><th>Symbol</th><th>Price</th><th>24h Change (%)</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- ðŸ”¹ AI Scanner -->
    <div class="section">
      <h2>AI Scanner Signals</h2>
      <table id="scan-table">
        <thead><tr><th>Symbol</th><th>Signal</th><th>Buy Price</th><th>Target</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- ðŸ”¹ Wallet -->
    <div class="section">
      <h2>Wallet Snapshot</h2>
      <p id="balance"></p>
      <table id="wallet-table">
        <thead><tr><th>Symbol</th><th>Amount</th><th>Value (USDT)</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

  </div>

  <script>
    const API_BASE = "https://dexscan-backend.onrender.com/api";

    async function fetchTop10() {
      const res = await fetch(`${API_BASE}/top10`);
      const data = await res.json();
      const table = document.querySelector("#top10-table tbody");
      table.innerHTML = data.map(d => `
        <tr>
          <td>${d.symbol}</td>
          <td>${parseFloat(d.price).toFixed(4)}</td>
          <td class="${d.change24h.startsWith('-') ? 'sell' : 'buy'}">${d.change24h}%</td>
        </tr>
      `).join("");
    }

    async function fetchScan() {
      const res = await fetch(`${API_BASE}/scan/results`);
      const data = await res.json();
      const table = document.querySelector("#scan-table tbody");
      table.innerHTML = data.map(d => `
        <tr>
          <td>${d.symbol}</td>
          <td class="${d.signal.includes('BUY') ? 'buy' : 'sell'}">${d.signal}</td>
          <td>${d.buyPrice}</td>
          <td>${d.targetPrice}</td>
        </tr>
      `).join("");
    }

    async function fetchWallet() {
      const res = await fetch(`${API_BASE}/wallet/fake`);
      const data = await res.json();
      document.getElementById("balance").innerText = `ðŸ’° Balance: ${data.balance} USDT`;
      const table = document.querySelector("#wallet-table tbody");
      table.innerHTML = data.holdings.map(h => `
        <tr>
          <td>${h.symbol}</td>
          <td>${h.amount}</td>
          <td>${h.value.toFixed(2)}</td>
        </tr>
      `).join("");
    }

    async function refreshAll() {
      await Promise.all([fetchTop10(), fetchScan(), fetchWallet()]);
    }

    refreshAll();
    setInterval(refreshAll, 20000); // auto-refresh every 20s
  </script>
</body>
</html>
